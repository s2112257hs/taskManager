<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
</head>
<body>
    <h2>Login</h2>
    <form id="loginForm" method="post">
        <label for="username">Username:</label><br>
        <input type="email" id="email" name="email" required><br><br>
        
        <label for="password">Password:</label><br>
        <input type="password" id="password" name="password" required><br><br>
        
        <button type="submit">Login</button>
    </form>
    <p>Don't have an account? <a href="signup.html">Sign up</a></p>
    <script>
        document.getElementById('loginForm').addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value; 

            const response = await fetch("http://127.0.0.1:5000/api/login", {
            method:"POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({email, password}),
            
            })
            const data = await response.json();
            if (data.token){
                localStorage.setItem("token", data.token);
                window.location.href = data.redirect;
            }
            else{
                alert(data.error)
            }
        });
        
    </script>
</body>
</html>